<!doctype html>
<!-- 
–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï

–¶–µ–ª—å: –°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –∏–≥—Ä—É "–°–∞–ø—ë—Ä" —Å –∞—É—Ç–µ–Ω—Ç–∏—á–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –≤ —Å—Ç–∏–ª–µ Windows 95/98 –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–¥–æ–±—Å—Ç–≤–∞ –∏–≥—Ä—ã.

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å:
   - –¢—Ä–∏ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –ª–µ–≥–∫–∏–π (9x9, 10 –º–∏–Ω), —Å—Ä–µ–¥–Ω–∏–π (16x16, 40 –º–∏–Ω), —Å–ª–æ–∂–Ω—ã–π (16x30, 99 –º–∏–Ω)
   - –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–ª–µ—Ç–æ–∫ –ª–µ–≤—ã–º –∫–ª–∏–∫–æ–º, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–æ–≤ –ø—Ä–∞–≤—ã–º –∫–ª–∏–∫–æ–º
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ–∏–≥—Ä—ã—à–∞ –Ω–∞ –ø–µ—Ä–≤–æ–º —Ö–æ–¥—É (–º–∏–Ω—ã —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å–æ—Å–µ–¥–Ω–∏—Ö –ø—É—Å—Ç—ã—Ö –∫–ª–µ—Ç–æ–∫
   - –ò–Ω–¥–∏–∫–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω –≤–æ–∫—Ä—É–≥ –æ—Ç–∫—Ä—ã—Ç–æ–π –∫–ª–µ—Ç–∫–∏
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∏–≥—Ä—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç

2. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
   - –¢–æ—á–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–∏–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ "–°–∞–ø—ë—Ä–∞" –∏–∑ Windows 95/98
   - –°—á–µ—Ç—á–∏–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –º–∏–Ω —Å LED-–¥–∏—Å–ø–ª–µ–µ–º
   - –¢–∞–π–º–µ—Ä —Å LED-–¥–∏—Å–ø–ª–µ–µ–º –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∏–≥—Ä—ã
   - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–º–∞–π–ª–∏–∫, –æ—Ç—Ä–∞–∂–∞—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
   - –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ —á–∏—Å–µ–ª –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è

3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
   - –†–µ–∂–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–≥—Ä—ã —Å –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–º —Ä–µ—à–µ–Ω–∏–µ–º
   - –ò–Ω–¥–∏–∫–∞—Ü–∏—è –ø–æ–±–µ–¥—ã/–ø–æ—Ä–∞–∂–µ–Ω–∏—è
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ JavaScript (–±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫)
2. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –∏–≥—Ä—ã
3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö –∫–ª–µ—Ç–æ–∫
4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏–≥—Ä—ã
5. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
6. –û—Ç–∑—ã–≤—á–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é
7. –¢–æ—á–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∏–ª—è Windows 95/98
-->

<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–°–∞–ø—ë—Ä</title>
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #c0c0c0;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        padding: 20px;
      }

      h1 {
        color: #333;
        margin-bottom: 15px;
        font-size: 32px;
      }

      .difficulty {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }

      .difficulty button {
        background-color: #c0c0c0;
        color: #000;
        border: 3px solid;
        border-color: #ffffff #808080 #808080 #ffffff;
        padding: 5px 10px;
        font-weight: bold;
        width: 100px;
        box-shadow:
          inset -1px -1px #0a0a0a,
          inset 1px 1px #dfdfdf;
      }

      .difficulty button:hover {
        background-color: #d1d1d1;
      }

      .difficulty button.active {
        background-color: #bdbdbd;
        border-color: #808080 #ffffff #ffffff #808080;
        box-shadow:
          inset 1px 1px #0a0a0a,
          inset -1px -1px #dfdfdf;
      }

      .game-container {
        position: relative;
        margin-bottom: 20px;
        border: 3px solid;
        border-color: #ffffff #808080 #808080 #ffffff;
        background-color: #c0c0c0;
        padding: 6px;
        box-shadow:
          inset -1px -1px #0a0a0a,
          inset 1px 1px #dfdfdf;
        box-sizing: border-box;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 6px;
        border: 2px solid;
        border-color: #808080 #ffffff #ffffff #808080;
        padding: 4px 6px;
        background-color: #c0c0c0;
      }

      .counter {
        background-color: #000;
        color: #f00;
        font-family: 'LCD', 'Digital', monospace;
        font-size: 24px;
        padding: 0;
        width: 48px;
        height: 28px;
        text-align: right;
        font-weight: bold;
        border: 1px solid #808080;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: inset 1px 1px 1px rgba(0, 0, 0, 0.5);
      }

      .smiley {
        width: 26px;
        height: 26px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 20px;
        background-color: #c0c0c0;
        border: 2px solid;
        border-color: #ffffff #808080 #808080 #ffffff;
        box-shadow:
          inset -1px -1px #0a0a0a,
          inset 1px 1px #dfdfdf;
        cursor: pointer;
        user-select: none;
      }

      .smiley:active {
        border-color: #808080 #ffffff #ffffff #808080;
        box-shadow:
          inset 1px 1px #0a0a0a,
          inset -1px -1px #dfdfdf;
      }

      .game-board {
        display: grid;
        gap: 0;
        border: 3px solid;
        border-color: #808080 #ffffff #ffffff #808080;
        background-color: #c0c0c0;
      }

      .cell {
        width: 16px;
        height: 16px;
        font-size: 12px;
        font-weight: bold;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        user-select: none;
        border: 2px solid;
        border-color: #ffffff #808080 #808080 #ffffff;
        background-color: #c0c0c0;
        box-sizing: border-box;
      }

      .cell:active:not(.revealed):not(.flag) {
        border-color: #808080 #ffffff #ffffff #808080;
      }

      .cell.revealed {
        border: 1px solid #808080;
        border-style: solid none none solid;
        background-color: #c0c0c0;
      }

      .cell.mine {
        background-color: #ff0000;
      }

      .cell.flag {
        background-color: #c0c0c0;
        position: relative;
      }

      .num-1 {
        color: blue;
      }
      .num-2 {
        color: green;
      }
      .num-3 {
        color: red;
      }
      .num-4 {
        color: darkblue;
      }
      .num-5 {
        color: #7b0000;
      }
      .num-6 {
        color: teal;
      }
      .num-7 {
        color: black;
      }
      .num-8 {
        color: #808080;
      }

      .controls {
        margin-top: 20px;
        display: flex;
        gap: 10px;
      }

      button {
        padding: 6px 12px;
        font-size: 14px;
        background-color: #c0c0c0;
        color: black;
        border: 2px solid;
        border-color: #ffffff #808080 #808080 #ffffff;
        box-shadow:
          inset -1px -1px #0a0a0a,
          inset 1px 1px #dfdfdf;
        cursor: pointer;
      }

      button:hover {
        background-color: #d1d1d1;
      }

      button:active {
        border-color: #808080 #ffffff #ffffff #808080;
        box-shadow:
          inset 1px 1px #0a0a0a,
          inset -1px -1px #dfdfdf;
      }

      .game-over {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        color: white;
        font-size: 24px;
        display: none;
      }

      .game-over button {
        margin-top: 20px;
        background-color: #c0c0c0;
        color: black;
      }

      .autoplay.active {
        background-color: #4caf50;
        color: white;
      }

      @font-face {
        font-family: 'LCD';
        src: url('https://cdn.jsdelivr.net/npm/digital-7-mono@1.0.0/index.ttf');
      }

      /* Windows 98 —Å—Ç–∏–ª—å –¥–ª—è –º–∏–Ω –∏ —Ñ–ª–∞–≥–æ–≤ */
      .cell.mine::after {
        content: '';
        width: 8px;
        height: 8px;
        background-color: black;
        border-radius: 50%;
        position: absolute;
      }

      .cell.flag::after {
        content: '';
        width: 0;
        height: 0;
        border-left: 2px solid transparent;
        border-right: 2px solid transparent;
        border-bottom: 8px solid red;
        position: absolute;
        top: 2px;
      }

      .cell.flag::before {
        content: '';
        width: 2px;
        height: 9px;
        background-color: black;
        position: absolute;
        left: 8px;
        top: 2px;
      }
    </style>
  </head>
  <body>
    <h1>–°–∞–ø—ë—Ä</h1>

    <div class="difficulty">
      <button id="easy" class="active">–õ–µ–≥–∫–∏–π</button>
      <button id="medium">–°—Ä–µ–¥–Ω–∏–π</button>
      <button id="hard">–°–ª–æ–∂–Ω—ã–π</button>
    </div>

    <div class="game-container">
      <div class="header">
        <div id="flags" class="counter">010</div>
        <div id="smiley" class="smiley">üòä</div>
        <div id="timer" class="counter">000</div>
      </div>
      <div class="game-board" id="board"></div>
      <div class="game-over" id="gameOver">
        <div id="gameOverText">–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</div>
        <button id="restartBtn">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
      </div>
    </div>

    <div class="controls">
      <button id="newGameBtn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
      <button id="autoplayBtn" class="autoplay">–ê–≤—Ç–æ–∏–≥—Ä–∞</button>
    </div>

    <script>
      // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
      const DIFFICULTY = {
        easy: { rows: 9, cols: 9, mines: 10 },
        medium: { rows: 16, cols: 16, mines: 40 },
        hard: { rows: 16, cols: 30, mines: 99 },
      };

      // –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –∏–≥—Ä—ã
      class Minesweeper {
        constructor(rows, cols, mineCount) {
          this.rows = rows;
          this.cols = cols;
          this.mineCount = mineCount;
          this.board = [];
          this.gameOver = false;
          this.revealed = 0;
          this.flagsPlaced = 0;
          this.timer = 0;
          this.timerInterval = null;
          this.firstClick = true;
          this.isWin = null;
          this.autoplayMode = false;
          this.autoplayInterval = null;
          this.autoplaySpeed = 300; // –°–∫–æ—Ä–æ—Å—Ç—å –∞–≤—Ç–æ–∏–≥—Ä—ã –≤ ms

          this.createBoard();
          this.renderBoard();
          this.updateFlagsCount();
          this.resetTimer();
          this.updateSmiley('üòä');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        createBoard() {
          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–≥–æ –ø–æ–ª—è
          this.board = [];
          for (let i = 0; i < this.rows; i++) {
            const row = [];
            for (let j = 0; j < this.cols; j++) {
              row.push({
                row: i,
                col: j,
                isMine: false,
                isRevealed: false,
                isFlagged: false,
                neighborMines: 0,
              });
            }
            this.board.push(row);
          }
        }

        // –†–∞–∑–º–µ—â–µ–Ω–∏–µ –º–∏–Ω –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞
        placeMines(clickedRow, clickedCol) {
          let minesPlaced = 0;

          while (minesPlaced < this.mineCount) {
            const row = Math.floor(Math.random() * this.rows);
            const col = Math.floor(Math.random() * this.cols);

            // –ù–µ —Ä–∞–∑–º–µ—â–∞–µ–º –º–∏–Ω—É –≤ –º–µ—Å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞ –∏ –≤–æ–∫—Ä—É–≥ –Ω–µ–≥–æ
            if (
              !this.board[row][col].isMine &&
              !(Math.abs(row - clickedRow) <= 1 && Math.abs(col - clickedCol) <= 1)
            ) {
              this.board[row][col].isMine = true;
              minesPlaced++;
            }
          }

          // –ü–æ–¥—Å—á–µ—Ç —Å–æ—Å–µ–¥–Ω–∏—Ö –º–∏–Ω –¥–ª—è –∫–∞–∂–¥–æ–π –∫–ª–µ—Ç–∫–∏
          for (let i = 0; i < this.rows; i++) {
            for (let j = 0; j < this.cols; j++) {
              if (!this.board[i][j].isMine) {
                this.board[i][j].neighborMines = this.countNeighborMines(i, j);
              }
            }
          }
        }

        // –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω –≤–æ–∫—Ä—É–≥ –∫–ª–µ—Ç–∫–∏
        countNeighborMines(row, col) {
          let count = 0;

          for (let i = -1; i <= 1; i++) {
            for (let j = -1; j <= 1; j++) {
              const newRow = row + i;
              const newCol = col + j;

              if (
                newRow >= 0 &&
                newRow < this.rows &&
                newCol >= 0 &&
                newCol < this.cols &&
                this.board[newRow][newCol].isMine
              ) {
                count++;
              }
            }
          }

          return count;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å–µ–¥–µ–π –∫–ª–µ—Ç–∫–∏
        getNeighbors(row, col) {
          const neighbors = [];

          for (let i = -1; i <= 1; i++) {
            for (let j = -1; j <= 1; j++) {
              if (i === 0 && j === 0) continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–∞–º—É –∫–ª–µ—Ç–∫—É

              const newRow = row + i;
              const newCol = col + j;

              if (
                newRow >= 0 &&
                newRow < this.rows &&
                newCol >= 0 &&
                newCol < this.cols
              ) {
                neighbors.push(this.board[newRow][newCol]);
              }
            }
          }

          return neighbors;
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        renderBoard() {
          const boardElement = document.getElementById('board');
          boardElement.innerHTML = '';

          // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏
          boardElement.style.gridTemplateColumns = `repeat(${this.cols}, 16px)`;
          boardElement.style.gridTemplateRows = `repeat(${this.rows}, 16px)`;

          for (let i = 0; i < this.rows; i++) {
            for (let j = 0; j < this.cols; j++) {
              const cell = document.createElement('div');
              cell.className = 'cell';
              cell.dataset.row = i;
              cell.dataset.col = j;

              if (this.board[i][j].isRevealed) {
                cell.classList.add('revealed');

                if (this.board[i][j].isMine) {
                  cell.classList.add('mine');
                  cell.textContent = 'üí£';
                } else if (this.board[i][j].neighborMines > 0) {
                  cell.textContent = this.board[i][j].neighborMines;
                  cell.classList.add(`num-${this.board[i][j].neighborMines}`);
                }
              } else if (this.board[i][j].isFlagged) {
                cell.classList.add('flag');
                cell.textContent = 'üö©';
              }

              // –°–æ–±—ã—Ç–∏—è –º—ã—à–∏
              cell.addEventListener('mousedown', () => {
                if (!this.gameOver && !this.board[i][j].isRevealed) {
                  this.updateSmiley('üòÆ');
                }
              });

              cell.addEventListener('mouseup', () => {
                if (!this.gameOver) {
                  this.updateSmiley('üòä');
                }
              });

              cell.addEventListener('click', () => this.handleCellClick(i, j));
              cell.addEventListener('contextmenu', e => {
                e.preventDefault();
                this.toggleFlag(i, j);
              });

              boardElement.appendChild(cell);
            }
          }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–ª–µ—Ç–∫–µ
        handleCellClick(row, col) {
          if (
            this.gameOver ||
            this.board[row][col].isRevealed ||
            this.board[row][col].isFlagged
          ) {
            return;
          }

          // –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫
          if (this.firstClick) {
            this.firstClick = false;
            this.placeMines(row, col);
            this.startTimer();
          }

          if (this.board[row][col].isMine) {
            this.revealMines();
            this.endGame(false);
            return;
          }

          this.revealCell(row, col);
          this.renderBoard();

          // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–±–µ–¥—É
          if (this.revealed === this.rows * this.cols - this.mineCount) {
            this.endGame(true);
          }
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–ª–µ—Ç–∫–∏
        revealCell(row, col) {
          if (
            row < 0 ||
            row >= this.rows ||
            col < 0 ||
            col >= this.cols ||
            this.board[row][col].isRevealed ||
            this.board[row][col].isFlagged
          ) {
            return;
          }

          this.board[row][col].isRevealed = true;
          this.revealed++;

          // –ï—Å–ª–∏ –∫–ª–µ—Ç–∫–∞ –ø—É—Å—Ç–∞—è - –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ
          if (this.board[row][col].neighborMines === 0) {
            for (let i = -1; i <= 1; i++) {
              for (let j = -1; j <= 1; j++) {
                this.revealCell(row + i, col + j);
              }
            }
          }
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞/—Å–Ω—è—Ç–∏–µ —Ñ–ª–∞–≥–∞
        toggleFlag(row, col) {
          if (this.gameOver || this.board[row][col].isRevealed) {
            return;
          }

          if (this.firstClick) {
            this.firstClick = false;
            this.placeMines(row, col);
            this.startTimer();
          }

          if (this.board[row][col].isFlagged) {
            this.board[row][col].isFlagged = false;
            this.flagsPlaced--;
          } else {
            // –ù–µ –ø–æ–∑–≤–æ–ª—è–µ–º —Å—Ç–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ñ–ª–∞–≥–æ–≤, —á–µ–º –º–∏–Ω
            if (this.flagsPlaced < this.mineCount) {
              this.board[row][col].isFlagged = true;
              this.flagsPlaced++;
            }
          }

          this.updateFlagsCount();
          this.renderBoard();
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –º–∏–Ω
        revealMines() {
          for (let i = 0; i < this.rows; i++) {
            for (let j = 0; j < this.cols; j++) {
              if (this.board[i][j].isMine) {
                this.board[i][j].isRevealed = true;
              }
            }
          }
          this.renderBoard();
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        endGame(isWin) {
          this.gameOver = true;
          this.isWin = isWin;
          clearInterval(this.timerInterval);

          // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–∏–≥—Ä—É
          this.stopAutoplay();

          // –û–±–Ω–æ–≤–ª—è–µ–º —Å–º–∞–π–ª–∏–∫
          this.updateSmiley(isWin ? 'üòé' : 'üòµ');

          // –ï—Å–ª–∏ –ø–æ–±–µ–¥–∞, –ø–æ–º–µ—á–∞–µ–º –≤—Å–µ –º–∏–Ω—ã —Ñ–ª–∞–∂–∫–∞–º–∏
          if (isWin) {
            for (let i = 0; i < this.rows; i++) {
              for (let j = 0; j < this.cols; j++) {
                if (this.board[i][j].isMine && !this.board[i][j].isFlagged) {
                  this.board[i][j].isFlagged = true;
                  this.flagsPlaced++;
                }
              }
            }
            this.updateFlagsCount();
            this.renderBoard();
          }

          const gameOverElement = document.getElementById('gameOver');
          const gameOverTextElement = document.getElementById('gameOverText');

          gameOverElement.style.display = 'flex';
          if (isWin) {
            gameOverTextElement.textContent = '–ü–æ–±–µ–¥–∞! –í—Å–µ –º–∏–Ω—ã –Ω–∞–π–¥–µ–Ω—ã!';
          } else {
            gameOverTextElement.textContent = '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –í—ã –ø–æ–¥–æ—Ä–≤–∞–ª–∏—Å—å –Ω–∞ –º–∏–Ω–µ!';
          }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —Ñ–ª–∞–≥–æ–≤
        updateFlagsCount() {
          const remainingFlags = this.mineCount - this.flagsPlaced;
          document.getElementById('flags').textContent = remainingFlags
            .toString()
            .padStart(3, '0');
        }

        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        startTimer() {
          this.timerInterval = setInterval(() => {
            this.timer++;
            if (this.timer > 999) this.timer = 999;
            document.getElementById('timer').textContent = this.timer
              .toString()
              .padStart(3, '0');
          }, 1000);
        }

        // –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞
        resetTimer() {
          clearInterval(this.timerInterval);
          this.timer = 0;
          document.getElementById('timer').textContent = this.timer
            .toString()
            .padStart(3, '0');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–º–∞–π–ª–∏–∫–∞
        updateSmiley(emoji) {
          document.getElementById('smiley').textContent = emoji;
        }

        // –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –∞–≤—Ç–æ–∏–≥—Ä—ã
        toggleAutoplay() {
          if (this.autoplayMode) {
            this.stopAutoplay();
          } else {
            this.startAutoplay();
          }
        }

        // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–∏–≥—Ä—ã
        startAutoplay() {
          if (this.gameOver) return;

          this.autoplayMode = true;
          document.getElementById('autoplayBtn').classList.add('active');

          // –ï—Å–ª–∏ –ø–µ—Ä–≤—ã–π —Ö–æ–¥, –Ω–∞—á–∏–Ω–∞–µ–º —Å —Ü–µ–Ω—Ç—Ä–∞
          if (this.firstClick) {
            const centerRow = Math.floor(this.rows / 2);
            const centerCol = Math.floor(this.cols / 2);
            this.handleCellClick(centerRow, centerCol);
          }

          // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –∞–≤—Ç–æ–∏–≥—Ä—ã
          this.autoplayInterval = setInterval(() => {
            if (this.gameOver) {
              this.stopAutoplay();
              return;
            }

            const madeMove = this.makeAutoMove();

            // –ï—Å–ª–∏ —Ö–æ–¥–æ–≤ –±–æ–ª—å—à–µ –Ω–µ—Ç, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–∏–≥—Ä—É
            if (!madeMove) {
              this.stopAutoplay();
            }
          }, this.autoplaySpeed);
        }

        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–∏–≥—Ä—ã
        stopAutoplay() {
          this.autoplayMode = false;
          document.getElementById('autoplayBtn').classList.remove('active');
          clearInterval(this.autoplayInterval);
        }

        // –°–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ö–æ–¥
        makeAutoMove() {
          // 1. –ò—â–µ–º –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–ª–µ—Ç–∫–∏ —Å —Ü–∏—Ñ—Ä–∞–º–∏, –≥–¥–µ –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Å–µ –º–∏–Ω—ã
          for (let i = 0; i < this.rows; i++) {
            for (let j = 0; j < this.cols; j++) {
              if (
                this.board[i][j].isRevealed &&
                !this.board[i][j].isMine &&
                this.board[i][j].neighborMines > 0
              ) {
                const neighbors = this.getNeighbors(i, j);
                const unopenedNeighbors = neighbors.filter(n => !n.isRevealed);
                const flaggedNeighbors = neighbors.filter(n => n.isFlagged);

                // –ï—Å–ª–∏ —á–∏—Å–ª–æ –º–∏–Ω —Ä–∞–≤–Ω–æ —á–∏—Å–ª—É –∑–∞–∫—Ä—ã—Ç—ã—Ö —Å–æ—Å–µ–¥–µ–π, –≤—Å–µ –æ–Ω–∏ - –º–∏–Ω—ã
                if (
                  unopenedNeighbors.length > 0 &&
                  this.board[i][j].neighborMines === unopenedNeighbors.length &&
                  flaggedNeighbors.length < unopenedNeighbors.length
                ) {
                  for (const neighbor of unopenedNeighbors) {
                    if (!neighbor.isFlagged) {
                      this.toggleFlag(neighbor.row, neighbor.col);
                      return true;
                    }
                  }
                }

                // –ï—Å–ª–∏ —á–∏—Å–ª–æ –º–∏–Ω —Ä–∞–≤–Ω–æ —á–∏—Å–ª—É –æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö —Ñ–ª–∞–≥–∞–º–∏, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã
                if (
                  unopenedNeighbors.length > 0 &&
                  flaggedNeighbors.length === this.board[i][j].neighborMines &&
                  unopenedNeighbors.length > flaggedNeighbors.length
                ) {
                  for (const neighbor of unopenedNeighbors) {
                    if (!neighbor.isFlagged) {
                      this.handleCellClick(neighbor.row, neighbor.col);
                      return true;
                    }
                  }
                }
              }
            }
          }

          // 2. –ï—Å–ª–∏ –Ω–µ—Ç –ª–æ–≥–∏—á–Ω–æ–≥–æ —Ö–æ–¥–∞, –ø—Ä–æ–±—É–µ–º —É–≥–∞–¥–∞—Ç—å —Å–∞–º—É—é –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∫–ª–µ—Ç–∫—É
          const lowestProbabilityCell = this.findLowestProbabilityCell();
          if (lowestProbabilityCell) {
            this.handleCellClick(lowestProbabilityCell.row, lowestProbabilityCell.col);
            return true;
          }

          // 3. –ï—Å–ª–∏ –≤—Å–µ –ø–µ—Ä–µ–ø—Ä–æ–±–æ–≤–∞–ª–∏, –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–ª–µ—Ç–∫—É
          const unopenedCells = [];
          for (let i = 0; i < this.rows; i++) {
            for (let j = 0; j < this.cols; j++) {
              if (!this.board[i][j].isRevealed && !this.board[i][j].isFlagged) {
                unopenedCells.push({ row: i, col: j });
              }
            }
          }

          if (unopenedCells.length > 0) {
            const randomCell =
              unopenedCells[Math.floor(Math.random() * unopenedCells.length)];
            this.handleCellClick(randomCell.row, randomCell.col);
            return true;
          }

          return false;
        }

        // –ü–æ–∏—Å–∫ –∫–ª–µ—Ç–∫–∏ —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –º–∏–Ω—ã
        findLowestProbabilityCell() {
          let bestCell = null;
          let lowestProbability = 1.1; // –ù–∞—á–∏–Ω–∞–µ–º —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –±–æ–ª—å—à–µ 1

          for (let i = 0; i < this.rows; i++) {
            for (let j = 0; j < this.cols; j++) {
              if (!this.board[i][j].isRevealed && !this.board[i][j].isFlagged) {
                // –ö–ª–µ—Ç–∫–∞ —Ä—è–¥–æ–º —Å –æ—Ç–∫—Ä—ã—Ç–æ–π –∏–º–µ–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ
                let hasRevealedNeighbor = false;
                let totalProbability = 0;
                let neighborCount = 0;

                const neighbors = this.getNeighbors(i, j);
                for (const neighbor of neighbors) {
                  if (neighbor.isRevealed) {
                    hasRevealedNeighbor = true;
                    if (neighbor.neighborMines > 0) {
                      const localNeighbors = this.getNeighbors(
                        neighbor.row,
                        neighbor.col
                      );
                      const unopenedLocalNeighbors = localNeighbors.filter(
                        n => !n.isRevealed && !n.isFlagged
                      );
                      const flaggedLocalNeighbors = localNeighbors.filter(
                        n => n.isFlagged
                      );

                      // –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å = (—á–∏—Å–ª–æ –º–∏–Ω - —á–∏—Å–ª–æ —Ñ–ª–∞–≥–æ–≤) / —á–∏—Å–ª–æ –Ω–µ–æ—Ç–∫—Ä—ã—Ç—ã—Ö —Å–æ—Å–µ–¥–µ–π
                      if (unopenedLocalNeighbors.length > 0) {
                        const probability =
                          (neighbor.neighborMines - flaggedLocalNeighbors.length) /
                          unopenedLocalNeighbors.length;
                        totalProbability += probability;
                        neighborCount++;
                      }
                    }
                  }
                }

                // –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ—Å–µ–¥–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π, —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω—é—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
                if (neighborCount > 0) {
                  const avgProbability = totalProbability / neighborCount;
                  if (avgProbability < lowestProbability) {
                    lowestProbability = avgProbability;
                    bestCell = { row: i, col: j };
                  }
                } else if (!hasRevealedNeighbor && !bestCell) {
                  // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Å–µ–¥–µ–π —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π, —ç—Ç–æ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                  bestCell = { row: i, col: j };
                }
              }
            }
          }

          return bestCell;
        }
      }

      // –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã
      let currentDifficulty = 'easy';
      let game = new Minesweeper(
        DIFFICULTY[currentDifficulty].rows,
        DIFFICULTY[currentDifficulty].cols,
        DIFFICULTY[currentDifficulty].mines
      );

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã
      function startNewGame() {
        // –ï—Å–ª–∏ –∞–≤—Ç–æ–∏–≥—Ä–∞ –∑–∞–ø—É—â–µ–Ω–∞ - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
        if (game.autoplayMode) {
          game.stopAutoplay();
        }

        game = new Minesweeper(
          DIFFICULTY[currentDifficulty].rows,
          DIFFICULTY[currentDifficulty].cols,
          DIFFICULTY[currentDifficulty].mines
        );
        document.getElementById('gameOver').style.display = 'none';
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫
      document.getElementById('newGameBtn').addEventListener('click', startNewGame);
      document.getElementById('restartBtn').addEventListener('click', startNewGame);
      document.getElementById('smiley').addEventListener('click', startNewGame);
      document.getElementById('autoplayBtn').addEventListener('click', () => {
        game.toggleAutoplay();
      });

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
      document.getElementById('easy').addEventListener('click', () => {
        setDifficulty('easy');
      });

      document.getElementById('medium').addEventListener('click', () => {
        setDifficulty('medium');
      });

      document.getElementById('hard').addEventListener('click', () => {
        setDifficulty('hard');
      });

      // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
      function setDifficulty(difficulty) {
        currentDifficulty = difficulty;

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
        document.querySelectorAll('.difficulty button').forEach(button => {
          button.classList.remove('active');
        });
        document.getElementById(difficulty).classList.add('active');

        // –û–±–Ω–æ–≤–ª—è–µ–º —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
        const gameContainer = document.querySelector('.game-container');
        if (difficulty === 'easy') {
          gameContainer.style.width = '240px';
        } else if (difficulty === 'medium') {
          gameContainer.style.width = '380px';
        } else {
          gameContainer.style.width = '600px';
        }

        startNewGame();
      }

      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
      document.querySelector('.game-container').style.width = '240px';

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –Ω–∞–≤–µ–¥–µ–Ω–∏—è –Ω–∞ –ø–æ–ª–µ
      document.addEventListener('mouseup', () => {
        if (game && !game.gameOver) {
          game.updateSmiley('üòä');
        }
      });
    </script>
  </body>
</html>
